---
title: "MP01: Netflix"
---

```{r}
#| echo: false
library(readr)
library(dplyr)

# Data Import
if(!dir.exists(file.path("data", "mp01"))){
  dir.create(file.path("data", "mp01"), showWarnings=FALSE, recursive=TRUE)
}

# File paths to tsv
GLOBAL_TOP_10_FILENAME <- file.path("data", "mp01", "global_top10_alltime.tsv")
COUNTRY_TOP_10_FILENAME <- file.path("data", "mp01", "country_top10_alltime.tsv")
```


```{r}
```


```{r}
```


```{r}
```


```{r}
```


```{r}
```


```{r}
# Downloading global data
if(!file.exists(GLOBAL_TOP_10_FILENAME)){
  download.file("https://www.netflix.com/tudum/top10/data/all-weeks-global.tsv",
                destfile=GLOBAL_TOP_10_FILENAME)
}

# Download country data if missing
if(!file.exists(COUNTRY_TOP_10_FILENAME)){
  download.file("https://www.netflix.com/tudum/top10/data/all-weeks-countries.tsv",
                destfile=COUNTRY_TOP_10_FILENAME)
}

# Read the data into R, treating "N/A" as proper NA
GLOBAL_TOP_10 <- read_tsv(GLOBAL_TOP_10_FILENAME, na = "N/A")
COUNTRY_TOP_10 <- read_tsv(COUNTRY_TOP_10_FILENAME, na = "N/A")

# Quick checks
glimpse(GLOBAL_TOP_10)
glimpse(COUNTRY_TOP_10)
print(COUNTRY_TOP_10_FILENAME)

# Total Number of Countries Netflix Operates in
country_count <- COUNTRY_TOP_10 |> 
  distinct(country_iso2) |> 
  nrow()

# Which non-English-language film has spent the most cumulative weeks in the global top 10? How many weeks did it spend?

##All Quiet on the Western Front. 23 Total Weeks!!
non_english_film <- GLOBAL_TOP_10 |>
  filter(category == "Films (Non-English)") |>
  group_by(show_title) |>
  summarise(total_weeks = max(cumulative_weeks_in_top_10, na.rm = TRUE)) |>
  arrange(desc(total_weeks)) |>
  slice(1)

#What is the longest film (English or non-English) to have ever appeared in the Netflix global Top 10? How long is it in minutes?

##Pushpa 2: The Rule (Reloaded Version) - 224 minutes
longest_film <- GLOBAL_TOP_10 |>
  filter(str_detect(category, "Films")) |>
  filter(!is.na(runtime)) |>
  mutate(runtime_minutes = round(60 * runtime)) |>
  arrange(desc(runtime_minutes)) |>
  slice(1)
# For each of the four categories, what program has the most total hours of global viewership?
top_programs_by_category <- GLOBAL_TOP_10 |>
  group_by(category, show_title) |>
  summarise(total_hours = sum(weekly_hours_viewed, na.rm = TRUE), .groups = "drop") |>
  group_by(category) |>
  slice_max(total_hours, n = 1) |>
  arrange(desc(total_hours))
top_programs_by_category |>
  mutate(total_hours = scales::comma(total_hours)) |>
  select(category, show_title, total_hours) |>
  format_titles() |>
  datatable(
    options = list(searching = FALSE, info = FALSE),
    caption = "Top Programs by Category"
  )
#Which TV show had the longest run in a country’s Top 10? How long was this run and in what country did it occur?
##Money Heist - Pakistan - 127 Weeks
longest_country_run <- COUNTRY_TOP_10 |>
  filter(str_detect(category, "TV")) |>
  group_by(country_name, show_title) |>
  summarise(max_weeks = max(cumulative_weeks_in_top_10, na.rm = TRUE), .groups = "drop") |>
  arrange(desc(max_weeks)) |>
  slice(1)
# Netflix provides over 200 weeks of service history for all but one country in our data set. Which country is this and when did Netflix cease operations in that country?
## Russia in February 2022
library(lubridate)
country_weeks <- COUNTRY_TOP_10 |>
  group_by(country_name) |>
  summarise(
    weeks_count = n_distinct(week),
    last_week = max(week, na.rm = TRUE),
    .groups = "drop"
  ) |>
  filter(weeks_count < 200) |>
  arrange(weeks_count)
#What is the total viewership of the TV show Squid Game?
##5,310,000,000 hours
squid_game_total <- GLOBAL_TOP_10 |>
  filter(str_detect(show_title, "Squid Game")) |>
  summarise(total_hours = sum(weekly_hours_viewed, na.rm = TRUE)) |>
  pull(total_hours)
#The movie Red Notice has a run-time of 1 hour and 58 minutes. Approximately how many views did it receive in 2021?
## 0 Views
library(lubridate)
red_notice_2021 <- GLOBAL_TOP_10 |>
  filter(show_title == "Red Notice", year(week) == 2021) |>
  summarise(total_views = sum(weekly_views, na.rm = TRUE)) |>
  pull(total_views)
#How many Films reached Number 1 in the US but did not originally debut there? What is the most recent film to pull this off?
## 45 total films - Kpop Demon Hunters?
us_films_analysis <- COUNTRY_TOP_10 %>%
  filter(country_name == "United States", grepl("Films", category)) %>%
  group_by(show_title) %>%
  arrange(week) %>%
  mutate(
    ever_hit_1 = any(weekly_rank == 1),
    debut_rank = first(weekly_rank)
  ) %>%
  filter(ever_hit_1 == TRUE, debut_rank > 1) %>%
  ungroup() %>%
  distinct(show_title) %>%
  nrow()

most_recent_film <- COUNTRY_TOP_10 %>%
  filter(country_name == "United States", grepl("Films", category)) %>%
  group_by(show_title) %>%
  arrange(week) %>%
  mutate(
    ever_hit_1 = any(weekly_rank == 1),
    debut_rank = first(weekly_rank),
    latest_week = max(week)
  ) %>%
  filter(ever_hit_1 == TRUE, debut_rank > 1) %>%
  ungroup() %>%
  arrange(desc(latest_week)) %>%
  slice(1)
# Which TV show/season hit the top 10 in the most countries in its debut week? In how many countries did it chart?
## Emily in Paris. 94 Countries.
tv_debut_countries <- COUNTRY_TOP_10 %>%
  filter(grepl("TV", category)) %>%
  group_by(show_title) %>%
  filter(week == min(week)) %>%
  summarise(countries_count = n_distinct(country_name), .groups = "drop") %>%
  arrange(desc(countries_count)) %>%
  slice(1)


## Stranger Things Season 5 Coming Out Soon!
## The Hawkins fab 5 are teaming up once again for a final stand against the upside down. The Netflix hit original series that has gathered nearly 3 billion viewing hours has fans re-binging just in time for Halloween season as the show is coming back for its 5th and final season. Being in the global top 10 for 19 consecutive weeks and only dominating similarly to Squid Games, Stranger Things has continued to be a mainstay in the top charts in the global markets and this final season should be a very successful bow on what has been a tremendous success for Netflix.
# Analyze Stranger Things most recent season data
stranger_things_data <- GLOBAL_TOP_10 %>%
  filter(grepl("Stranger", show_title)) %>%
  arrange(desc(week)) %>%
  slice_head(n = 50) %>%
  summarise(
    total_viewing_hours = sum(weekly_hours_viewed, na.rm = TRUE),
    max_weeks = max(cumulative_weeks_in_top_10, na.rm = TRUE)
  )

# Find comparable shows
comparable_shows <- GLOBAL_TOP_10 %>%
  filter(category == "TV (English)", !grepl("Stranger", show_title)) %>%
  group_by(show_title) %>%
  summarise(total_hours = sum(weekly_hours_viewed, na.rm = TRUE)) %>%
  arrange(desc(total_hours)) %>%
  slice(1:2) %>%
  pull(show_title)

comparable_show_1 <- comparable_shows[1]
comparable_show_2 <- comparable_shows[2]
#India Continuing to Dominate on Netflix
##Netflix’s expansion in India stands out as a remarkable success. Over time, 1,168 unique titles have appeared in the country’s Top 10 charts, accounting for 4,420 weekly entries. Shows like The Great Indian Kapil Show became major hits locally, despite having little presence in U.S. rankings, highlighting the impact of content customized for specific languages and cultural tastes.

##Examining trends over time, Netflix’s content diversity in India has grown, with an average of 39 different programs appearing in the Top 10 each week. With an estimated 30–40 million subscribers based on engagement patterns, India ranks among Netflix’s largest and fastest-growing markets. Notably, 71 shows—including hits like Money Heist—remained in India’s Top 10 for over 10 weeks, demonstrating both the company’s expanding reach and the long-term potential of India as a key growth market.
india_total_shows <- COUNTRY_TOP_10 |>
  filter(country_name == "India") |>
  distinct(show_title) |>
  nrow()

india_total_weeks <- COUNTRY_TOP_10 |>
  filter(country_name == "India") |>
  nrow()

india_shows <- COUNTRY_TOP_10 |>
  filter(country_name == "India") |>
  group_by(show_title) |>
  summarise(weeks = n(), .groups = "drop") |>
  arrange(desc(weeks))

us_shows <- COUNTRY_TOP_10 |>
  filter(country_name == "United States") |>
  distinct(show_title)

india_only <- anti_join(india_shows, us_shows, by = "show_title")
popular_show_not_in_US <- if(nrow(india_only) > 0) {
  india_only$show_title[1]
} else {
  "regional content"
}

most_popular_india <- india_shows |>
  slice(1)

top_show_india <- if(nrow(most_popular_india) > 0) {
  most_popular_india$show_title
} else {
  "top shows"
}

long_running_shows <- india_shows |>
  filter(weeks > 10) |>
  nrow()

india_monthly <- COUNTRY_TOP_10 |>
  filter(country_name == "India") |>
  mutate(month = format(week, "%Y-%m")) |>
  group_by(month) |>
  summarise(shows = n_distinct(show_title), .groups = "drop") |>
  arrange(month)

growth_trend <- if(nrow(india_monthly) > 1) {
  if(tail(india_monthly$shows, 1) > head(india_monthly$shows, 1)) "increased" else "remained stable"
} else {
  "grown"
}

avg_shows_per_week <- round(mean(india_monthly$shows, na.rm = TRUE))

subscriber_estimate <- "30-40 million"

#Massive Risks Created Massive Reward - 2022 - 2025 The Global Dominance of Netflix
##February 24, 2022, was a dark day in European history as Russia began deploying troops in Ukraine. Global outrage on Russia full scale war effort saw large efforts in international companies and committees no longer recognizing Russia. On February 27, 2022, Netflix was one of the companies that pulled the plug on subscribers being able to stream their favorite movies and TV shows. The immediate result, detrimental, Netflix reported poor quarterly earnings losing 200,000 subscribers when looking to gain an additional 2.5 million subscribers. This caused the share value of Netflix to plummet 45% in April and Netflix had to pivot, where to dominate next? Netflix then began investing in the Asian market, where over the span of 3 years has seen shows: Squid Games, Kpop Demon Hunters, RRR dominate. Squid Games has become the most viewed show in Netflix history and overall the Asian market has rebounded Netflix in its entirety, with overall share price increasing by over 600% since its Q1 report in 2022. With no signs of bringing services back to one of the platforms largest users, Netflix has reshaped its company to invest in new markets to gain incredible international success.
library(lubridate)
country_weeks <- COUNTRY_TOP_10 |>
  group_by(country_name) |>
  summarise(
    weeks_count = n_distinct(week),
    last_week = max(week, na.rm = TRUE),
    .groups = "drop"
  ) |>
  filter(weeks_count < 200) |>
  arrange(weeks_count)
#What is the total viewership of the TV show Squid Game?
##5,310,000,000 hours
squid_game_total <- GLOBAL_TOP_10 |>
  filter(str_detect(show_title, "Squid Game")) |>
  summarise(total_hours = sum(weekly_hours_viewed, na.rm = TRUE)) |>
  pull(total_hours)